<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Send emails</title>
    <style type="text/css">
* {
    font-family: 'Courier New', Courier, monospace;
}        
    </style>
</head>
<body>
  <h1>Email sender</h1>  
  <a id="email-link" href="mailto:?bcc=olivier@lediouris.net,olivier.lediouris@gmail.com&subject=BCC%20test">Send email</a>
  <hr/>
  <small><i>OlivSoft never stops</i></small>  
</body>
<script type="text/javascript">
    window.onload = () => {

    fetch("../members.json")
            .then(response => {
                console.log(`Data Response: ${response.status} - ${response.statusText}`);
                response.json().then(doc => {
                    let members = doc;
                    console.log(`Data loaded, ${doc.length} elements`);
                    let bccString = "";
                    members.forEach(element => {
                        bccString += (element.email + ";");
                    });
                    console.log(`bcc=${bccString}`);
                    let emailLink = document.getElementById('email-link');
                    emailLink.href = `mailto:?bcc=${bccString}&subject=News%20letter%20#4`;
                });
            },
            (error, errmess) => {
                console.log("Ooch");
                let message;
                if (errmess) {
                    let mess = JSON.parse(errmess);
                    if (mess.message) {
                        message = mess.message;
                    }
                }
                console.debug("Failed to get Path data..." + (error ? JSON.stringify(error, null, 2) : ' - ') + ', ' + (message ? message : ' - '));
            });

    }
</script>
</html>