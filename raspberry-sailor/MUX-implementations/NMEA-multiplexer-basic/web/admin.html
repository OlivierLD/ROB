<!DOCTYPE html>
<!--
 | This is an example illustrating the way to use the
 | REST API provided to administer the NMEA Multiplexer
 | Provided "as is".
 | The main goal is to have something LIGHT!
 | It needs to run fine, even on small boards like the Raspberry Pi Zero,
 | and for now, it does.
 |
 | Also see mux.rest.js. It contains some logic associated with this dashboard.
 +-->
<html lang="en">
<head>
    <title>NMEA Multiplexer Admin</title>

    <!--link rel="icon" type="image/ico" href="icons/ajax.ico"-->
    <link rel="icon" type="image/jpg" href="icons/palm.04.jpg">

    <script type="text/javascript" src="./js/pub.sub.js"></script>
    <script type="text/javascript" src="./js/mux.rest.js"></script>
    <script type="text/javascript" src="./widgets/Graph.js"></script>
    <link id="page-ux" rel="stylesheet" href="./css/stylesheet.css" type="text/css"/>
    <style>

      button {
        border-radius: 5px;
        background-color: rgba(255, 165, 0, 0.5);
      }

      .selectedButton {
        padding:5px;
        border-top-right-radius: 10px;
        border:1px solid #CCC;
        margin-top:10px;
        border-bottom: none;
        font-size: 12px;
        font-weight: bold;
      }
      .unselectedButton {
        padding:5px;
        border-top-right-radius: 10px;
        border:1px solid #CCC;
        margin-top:10px;
        border-bottom: none;
        font-size: 12px;
        font-weight: normal;
      }
      .addbox {
        padding: 1px;
        border-radius: 5px;
        border: 1px solid #CCC;
        width: auto;
        height: auto;
        margin: 80px auto 0px auto;
        overflow: auto;
      }

      th, td {
         border: 1px solid #CCC;
         border-radius: 5px;
         padding: 3px;
      }

      canvas {
        width: 100%;
        height: 100px;
      }

      .smooth {
        /*height: 0;*/
        /*visibility: hidden;*/
        /*opacity: 0;*/
        /*transition: visibility 0.5s, height 0.5s, opacity 0.5s linear;*/
        height: 0;
        max-height: 0;
        margin: auto;
        /*transition: transform 0.5s, max-height 1s, height 1s;*/
        transition: all 0.5s ease;
        opacity: 0;
        transform: scaleY(0);
        transform-origin: top;
        overflow: hidden;
      }

      .visible-div {
        opacity: 1;
        width: auto;
        height: auto;
        max-height: 1600px;
        transform: scaleY(1);
        margin-top: 5px;
      }

    </style>
    <link id="graph-ux" rel="stylesheet" href="css/graph.ux.01.css" type="text/css"/>
    <script type="text/javascript">

        function cssSelectManager() {
            let x = document.getElementById("css-select").value;
            let css = document.getElementById("page-ux");
            let cssName = "./css/" + x;
            css.href =  cssName;
        }
        function graphCssSelectManager() {
            let x = document.getElementById("graph-css-select").value;
            let css = document.getElementById("graph-ux");
            let cssName = "./css/" + x;
            css.href =  cssName;
            // Broadcast the event, for reload of the css by the component.
            events.publish('color-scheme-changed', cssName); // Name is not used...
        }

        /**
         * Displays the errors in a non-modal way.
         * @param mess the error message to display.
         */
        let errMessages = [];
        const MAX_NB_MESS = 10;
        function errorHandler(mess) {
          let messZone = document.getElementById("err-mess");
          if (false) { // Stby
            messZone.innerText = mess;
            setTimeout(function() {
                messZone.innerText = "";
            }, 10000);
          } else {
            errMessages.push(`${new Date()}: ${mess}`);
            while (errMessages.length > MAX_NB_MESS) {
              errMessages.slice(0);
            }
            let newMessage = '';
            errMessages.forEach(mess => newMessage += (mess + "\n"));
            messZone.innerText = newMessage;
            messZone.scrollTop = messZone.scrollHeight; // Scroll at the bottom
          }
        }

        // Executed at startup
        (function () {
            errManager.display = errorHandler; // in mux.rest.js
        })();

        function channelSelectManager() {
            let x = document.getElementById("channel-select").value;
            manageChannelSelection(x);
        }

        function forwardSelectManager() {
            let x = document.getElementById("forwarder-select").value;
            manageForwardSelection(x);
        }

        function computerSelectManager() {
            let x = document.getElementById("computer-select").value;
            manageComputerSelection(x);
        }

        let showRESTData = false;
        function showHideRESTData() {
            showRESTData = !showRESTData;
            if (showRESTData) {
              showDiv("raw-data-div");
            } else {
              hideDiv("raw-data-div");
            }

            document.getElementById("show-hide-raw-data").innerHTML = (showRESTData ? "<small>&nbsp;<img src='pandown.gif'> Hide REST Traffic</small>" : "<small>&nbsp;<img src='panright.gif'> Show REST Traffic</small>");
        }

        const CHANNELS = [
          "channel-serial",
          "channel-tcp",
          "channel-file",
          "channel-ws",
          "channel-rnd",
          // "channel-bmp180",
          // "channel-bme280",
          // "channel-lsm303",
          // "channel-htu21df",
          "channel-zda",
          "channel-rest",
          "channel-custom"
        ];
        const FORWARDERS = [
          "forward-serial",
          "forward-tcp",
          "forward-rest",
          "forward-gpsd",
          "forward-rmi",
          "forward-file",
          "forward-ws",
          "forward-console",
          "forward-custom"
        ];
        const COMPUTERS = [
          "computer-twc",
          "computer-custom"
        ];

        function onOrOff(idsArray, toTurnOn) {
          idsArray.forEach(channel => document.getElementById(channel).style.display = (channel === toTurnOn ? 'inline' : 'none'));
        }

        function manageChannelSelection(selected) {
            switch (selected) {
                case 'serial':
                  onOrOff(CHANNELS, "channel-serial");
                  break;
                case 'tcp':
                  onOrOff(CHANNELS, "channel-tcp");
                  break;
                case 'file':
                  onOrOff(CHANNELS, "channel-file");
                  break;
                case 'ws':
                  onOrOff(CHANNELS, "channel-ws");
                  break;
                case 'rnd':
                  onOrOff(CHANNELS, "channel-rnd");
                  break;
                // case 'bmp180':
                //     onOrOff(CHANNELS, "channel-bmp180");
                //     break;
                // case 'bme280':
                //     onOrOff(CHANNELS, "channel-bme280");
                //     break;
                // case 'lsm303':
                //     onOrOff(CHANNELS, "channel-lsm303");
                //     break;
                // case 'htu21df':
                //     onOrOff(CHANNELS, "channel-htu21df");
                //     break;
                case 'zda':
                  onOrOff(CHANNELS, "channel-zda");
                  break;
                case 'rest':
                  onOrOff(CHANNELS, "channel-rest");
                  break;
                case 'custom':
                  onOrOff(CHANNELS, "channel-custom");
                  break;
                default:
                  break;
            }
        }

        function manageForwardSelection(selected) {
            switch (selected) {
              case 'serial':
                onOrOff(FORWARDERS, "forward-serial");
                break;
              case 'tcp':
                onOrOff(FORWARDERS, "forward-tcp");
                break;
              case 'rest':
                onOrOff(FORWARDERS, "forward-rest");
                break;
              case 'gpsd':
                onOrOff(FORWARDERS, "forward-gpsd");
                break;
              case 'rmi':
                onOrOff(FORWARDERS, "forward-rmi");
                break;
              case 'file':
                onOrOff(FORWARDERS, "forward-file");
                break;
              case 'ws':
                onOrOff(FORWARDERS, "forward-ws");
                break;
              case 'console':
                onOrOff(FORWARDERS, "forward-console");
                break;
              case 'custom':
                onOrOff(FORWARDERS, "forward-custom");
                break;
              default:
                break;
            }
        }

        function manageComputerSelection(selected) {
            switch (selected) {
                case 'tw-current':
                  onOrOff(COMPUTERS, "computer-twc");
                  break;
                case 'custom':
                  onOrOff(COMPUTERS, "computer-custom");
                  break;
                default:
                  break;
            }
        }

        function requestChannelCreation() {
            let x = document.getElementById("channel-select").value;
            let dFilters, sFilters, port, server, portName, br, dPrefix;
            switch (x) {
                case 'serial':
                    portName = document.getElementById("serial-port").value;
                    br = document.getElementById("baud-rate").value;
                    if (portName.trim().length === 0 || br.trim().length === 0) {
                        alert('Both port name and baud rate are required');
                        return;
                    }
                    dFilters = document.getElementById("serial-dev-filters").value.split(",");
                    sFilters = document.getElementById("serial-sentence-filters").value.split(",");
                    createChannel({
                        type: 'serial',
                        port: portName,
                        br: br,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                case 'tcp':
                    port = document.getElementById("tcp-port").value;
                    server = document.getElementById("tcp-server").value;
                    if (port.trim().length === 0 || server.trim().length === 0) {
                        alert('Both port and server name are required');
                        return;
                    }
                    initialRequest = document.getElementById("tcp-initial-request").value;
                    keepTrying = document.getElementById("tcp-keep-trying").checked;
                    dFilters = document.getElementById("tcp-dev-filters").value.split(",");
                    sFilters = document.getElementById("tcp-sentence-filters").value.split(",");
                    createChannel({
                        type: 'tcp',
                        port: port,
                        hostname: server,
                        initialRequest: initialRequest,
                        keepTrying: keepTrying,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                case 'file':  //TODO Zip prms
                    let logfile = document.getElementById("data-file").value;
                    if (logfile.trim().length === 0) {
                        alert('Log file name required');
                        return;
                    }
                    let pause = document.getElementById("data-between-reads").value.trim();
                    let betweenReads;
                    try {
                        betweenReads = parseInt(pause);
                    } catch (error) {
                        betweenReads = 500;
                    }
                    dFilters = document.getElementById("data-dev-filters").value.split(",");
                    sFilters = document.getElementById("data-sentence-filters").value.split(",");
                    createChannel({
                        type: 'file',
                        file: logfile,
                        pause: betweenReads,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                case 'ws':
                    let uri = document.getElementById("wsuri").value;
                    if (uir.trim().length === 0) {
                        alert('WebSocket URI is required');
                        return;
                    }
                    dFilters = document.getElementById("ws-dev-filters").value.split(",");
                    sFilters = document.getElementById("ws-sentence-filters").value.split(",");
                    createChannel({
                        type: 'ws',
                        wsUri: uri,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                case 'rnd':
                    dFilters = document.getElementById("rnd-dev-filters").value.split(",");
                    sFilters = document.getElementById("rnd-sentence-filters").value.split(",");
                    createChannel({
                        type: 'rnd',
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                /*
                case 'bmp180':
                    dFilters = document.getElementById("bmp180-dev-filters").value.split(",");
                    sFilters = document.getElementById("bmp180-sentence-filters").value.split(",");
                    dPrefix = document.getElementById('bmp180-dev-prefix').value;
                    createChannel({
                        type: 'bmp180',
                        devicePrefix: dPrefix,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                case 'bme280':
                    dFilters = document.getElementById("bme280-dev-filters").value.split(",");
                    sFilters = document.getElementById("bme280-sentence-filters").value.split(",");
                    dPrefix = document.getElementById('bme280-dev-prefix').value;
                    createChannel({
                        type: 'bme280',
                        devicePrefix: dPrefix,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                case 'lsm303':
                    dFilters = document.getElementById("lsm303-dev-filters").value.split(",");
                    sFilters = document.getElementById("lsm303-sentence-filters").value.split(",");
                    dPrefix = document.getElementById('lsm303-dev-prefix').value;
                    let hOffset = document.getElementById('lsm303-heading-offset').value;
	                	let rFreq = document.getElementById('lsm303-read-frequency').value;
	                	let dampSize = document.getElementById('lsm303-damping-size').value;
                    createChannel({
                        type: 'lsm303',
                        devicePrefix: dPrefix,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters,
                        headingOffset: hOffset,
												readFrequency: rFreq,
												dampingSize: dampSize
                    });
                    break;
                case 'htu21df':
                    dFilters = document.getElementById("htu21df-dev-filters").value.split(",");
                    sFilters = document.getElementById("htu21df-sentence-filters").value.split(",");
                    dPrefix = document.getElementById('htu21df-dev-prefix').value;
                    createChannel({
                        type: 'htu21df',
                        devicePrefix: dPrefix,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                */
                case 'zda':
                    dFilters = document.getElementById("zda-dev-filters").value.split(",");
                    sFilters = document.getElementById("zda-sentence-filters").value.split(",");
                    dPrefix = document.getElementById('zda-dev-prefix').value;
                    createChannel({
                        type: 'zda',
                        devicePrefix: dPrefix,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                case 'rest':
                    protocol = document.getElementById("rest-protocol").value;
                    port = document.getElementById("rest-port").value;
                    server = document.getElementById("rest-server").value;
                    path = document.getElementById("rest-path").value;
                    qs = document.getElementById("rest-qs").value;
                    jqs = document.getElementById("rest-jqs").value;
                    frequency = document.getElementById("rest-freq").value;
                    if (port.trim().length === 0 || server.trim().length === 0) {
                        alert('Both port and server name are required');
                        return;
                    }
                    dFilters = document.getElementById("rest-dev-filters").value.split(",");
                    sFilters = document.getElementById("rest-sentence-filters").value.split(",");
                    createChannel({
                        type: 'rest',
                        protocol: protocol,
                        hostname: server,
                        port: port,
                        queryPath: path,
                        queryString: qs,
                        jsonQueryString: jqs,
                        frequency: frequency,
                        devicePrefix: dPrefix,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                case 'custom':
                    let clientClass = document.getElementById("ch-custom-class").value;
                    let readerClass = document.getElementById("ch-custom-reader").value;
                    let propfile = document.getElementById("ch-custom-prop-file").value;
                    dFilters = document.getElementById("ch-custom-dev-filters").value.split(",");
                    sFilters = document.getElementById("ch-custom-sentence-filters").value.split(",");
                    createChannel({
                        type: 'custom',
                        clientClass: clientClass,
                        readerClass: readerClass,
                        propFile: propfile,
                        deviceFilters: dFilters,
                        sentenceFilters: sFilters
                    });
                    break;
                default:
                    break;
            }
        }

        function requestForwardCreation() {
            let x = document.getElementById("forwarder-select").value;
            let port;
          switch (x) {
            case 'serial':
              let portName = document.getElementById("serial-port-fwd").value;
              let br = document.getElementById("baud-rate-fwd").value;
              if (portName.trim().length === 0 || br.trim().length === 0) {
                alert('Both port name and baud rate are required');
                return;
              }
              createForwarder({
                type: 'serial',
                port: portName,
                br: br
              });
              break;
            case 'tcp':
              port = document.getElementById("fwd-tcp-port").value;
              if (port.trim().length === 0) {
                alert('Port is required');
                return;
              }
              createForwarder({
                type: 'tcp',
                port: port
              });
              break;
            case 'rest':
              let protocol = document.getElementById("fwd-rest-protocol").value;
              let verb = document.getElementById("fwd-rest-verb").value;
              let server = document.getElementById("fwd-rest-server").value;
              if (server.trim().length === 0) {
                server = "127.0.0.1";
              }
              port = document.getElementById("fwd-rest-port").value;
              if (port.trim().length === 0) {
                port = 80;
              }
              let resource = document.getElementById("fwd-rest-resource").value;
              createForwarder({
                type: 'rest',
                protocol: protocol,
                verb: verb,
                serverName: server,
                port: port,
                resource: resource
              });
              break;
            case 'gpsd':
              port = document.getElementById("fwd-gpsd-port").value;
              if (port.trim().length === 0) {
                alert('Port is required');
                return;
              }
              createForwarder({
                type: 'gpsd',
                port: port
              });
              break;
            case 'rmi':
              port = document.getElementById("fwd-rmi-port").value;
              if (port.trim().length === 0) {
                alert('Port is required');
                return;
              }
              let name = document.getElementById("fwd-rmi-binding-name").value;
              if (name.trim().length === 0) {
                alert('Name is required');
                return;
              }
              createForwarder({
                type: 'rmi',
                port: port,
                bindingName: name
              });
              break;
            case 'file':
              let fwdPayload = {};
              if (document.getElementById('tbfn').checked) { // Time based name

                let suffix = document.getElementById('fwd-data-file-tb-suffix').value;
                let logDir = document.getElementById('fwd-data-file-tb-log-dir').value;
                let split = document.getElementById('fwd-data-file-tb-split').value;
                let flush = document.getElementById("fwd-data-file-tb-flush").checked;

                fwdPayload = {
                  type: 'file',
                  timeBased: true,
                  radix: suffix,
                  dir: logDir,
                  split: split,
                  flush: flush
                };

              } else { // NOT time based
                let logfile = document.getElementById("fwd-data-file").value;
                if (logfile.trim().length === 0) {
                  alert('Log file name is required');
                  return;
                }
                let append = document.getElementById("fwd-data-file-app").checked;
                let flush = document.getElementById("fwd-data-file-flush").checked;

                fwdPayload = {
                  type: 'file',
                  timeBased: false,
                  log: logfile,
                  append: append
                };
              }
              createForwarder(fwdPayload);
              break;
            case 'ws':
              let uri = document.getElementById("fwd-wsuri").value;
              if (uri.trim().length === 0) {
                alert('WebSocket URI is required');
                return;
              }
              createForwarder({
                type: 'ws',
                wsUri: uri
              });
              break;
            case 'console':
              createForwarder({
                type: 'console'
              });
              break;
            case 'custom':
              let forwarderClass = document.getElementById("fwd-custom-class").value;
              let propfile = document.getElementById('fwd-custom-prop-file').value;
              createForwarder({
                type: 'custom',
                forwarderClass: forwarderClass,
                propFile: propfile
              });
              break;
            default:
              break;
          }
        }

        function requestComputerCreation() {
            let x = document.getElementById("computer-select").value;
            switch (x) {
                case 'tw-current':
                    let prefix = document.getElementById("cptr-twc-prefix").value;
                    let tbl = document.getElementById("cptr-twc-tbl").value;
                    if (prefix.trim().length === 0 || tbl.trim().length === 0) {
                        alert('Prefix and TimeBuffer length are required');
                        return;
                    }
                    createComputer({
                        type: 'tw-current',
                        prefix: prefix,
                        timeBufferLength: tbl
                    });
                    break;
                case 'custom':
                    let computerClass = document.getElementById("cptr-custom-class").value;
                    let propfile = document.getElementById('cptr-custom-prop-file').value;
                    createComputer({
                        type: 'custom',
                        computerClass: computerClass,
                        propFile: propfile
                    });
                    break;
                default:
                    break;
            }
        }

        function manageClick(div) {
            document.getElementById('showPorts').className = (div.id === 'showPorts' ? 'selectedButton' : 'unselectedButton');
            document.getElementById('showChannels').className = (div.id === 'showChannels' ? 'selectedButton' : 'unselectedButton');
            document.getElementById('showForwarders').className = (div.id === 'showForwarders' ? 'selectedButton' : 'unselectedButton');
            document.getElementById('showComputers').className = (div.id === 'showComputers' ? 'selectedButton' : 'unselectedButton');
            document.getElementById('showDiagram').className = (div.id === 'showDiagram' ? 'selectedButton' : 'unselectedButton');
            document.getElementById('showCache').className = (div.id === 'showCache' ? 'selectedButton' : 'unselectedButton');
            switch (div.id) {
                case 'showPorts':
                    serialPortList();
                    break;
                case 'showChannels':
                    channelList();
                    break;
                case 'showForwarders':
                    forwarderList();
                    break;
                case 'showComputers':
                    computerList();
                    break;
                case 'showDiagram':
                    generateDiagram();
                    break;
                case 'showCache':
                    generateCache();
                    break;
                default:
                    break;
            }
        }

        let flowGraph; // The graph itself.
        let flowData = [];
        const GRAPH_MAX_LEN = 300; // 60 = 1 minute

        let idx2plot;

        function graphCallback(idx) {
            console.log("Click on pos " + idx + ", flow " + flowData[idx].getY());
            idx2plot = idx;
        }

        window.onload = () => {
          // Available when canvas is visible
          flowGraph = new Graph("flowCanvas", flowData, graphCallback, "b/s");

          let interv = setInterval(() => {
              dataVolume();
              forwarderStatus();
              flowGraph.drawGraph("flowCanvas", flowData, idx2plot);
          }, 1000);
        };

        let graphVisible = false;
        function showHideGraph() {
            if (flowData.length >= 10) {
                graphVisible = !graphVisible;
             // document.getElementById("graphdiv").css('display', graphVisible ? 'block' : 'none');
                if (graphVisible) {
                  showDiv("graphdiv");
                } else {
                  hideDiv("graphdiv");
                }
            } else {
                alert("Not enough data to show on the graph... \n" +
                      "Need at least 10 data points, just got " + flowData.length + "\n" +
                      "Please wait!");
            }
        }

        function toggleForwarders() {
          if ("ON" === document.getElementById("forwarders-status").innerText) {
            enableLogging(false);
          } else {
            enableLogging(true);
          }
        }

        function setSmooth(cb) {
            flowGraph.setSmoothing(cb.checked);
        }

        function setTooltip(cb) {
            flowGraph.setTooltip(cb.checked);
        }

        let inboundDataInterval;
        function showInboundData(cb) {
            if (cb.checked) {
                showDiv("inbound-data-div");
                pingLastSentence();
            } else {
                hideDiv("inbound-data-div");
                clearInterval(inboundDataInterval);
            }
        }

        function pingLastSentence() {
          inboundDataInterval = setInterval(getLastNMEASentence, 1000);
        }

        function shutdownMux() {
          if (confirm("You are about to bring the whole Multiplexer down.\nPlease confirm.") === true) {
            terminate();
            document.body.innerHTML = '<h1>Bye-bye...</h1>' +
            '<h2>Server is going down upon your request.</h2>' +
            '<p>Restart the server from a console to resume...</p>';
          } else {
            console.log('Canceled');
          }
        }

        function getSystemDate() {
            let promise = systemDate();
            promise.then((value) => {
                console.log(value);
                let sysDate = JSON.parse(value)
                document.getElementById('system-day').value = sysDate.day;
                document.getElementById('system-month').value = sysDate.month;
                document.getElementById('system-year').value = sysDate.year;
                document.getElementById('system-hours').value = sysDate.hours;
                document.getElementById('system-mins').value = sysDate.mins;
                document.getElementById('system-secs').value = sysDate.secs;
            }, (error, errMess) => {
                let message;
                if (errMess !== undefined) {
                    if (errMess.message !== undefined) {
                        message = errMess.message;
                    } else {
                        message = errMess;
                    }
                }
                errManager.display("Failed to get System Date..." + (error !== undefined ? JSON.stringify(error) : ' - ') + ', ' + (message !== undefined ? message : ' - '));
            });
        }

        function setSystemDate() {
            let day = document.getElementById('system-day').value;
            let month = document.getElementById('system-month').value;
            let year = document.getElementById('system-year').value;
            let hours = document.getElementById('system-hours').value;
            let mins = document.getElementById('system-mins').value;
            let secs = document.getElementById('system-secs').value;
            let newFmtDate = `${lpad(day, '0', 2)} ${month} ${lpad(year, '0', 4)} ${lpad(hours, '0', 2)}:${lpad(mins, '0', 2)}:${lpad(secs, '0', 2)}`;
            let promise = updateSystemDate(newFmtDate);
            promise.then(retVal => {
                console.log(`SystemDate - success ${retVal}`);
            }, (error, errMess) => {
                let message;
                if (errMess !== undefined) {
                    if (errMess.message !== undefined) {
                        message = errMess.message;
                    } else {
                        message = errMess;
                    }
                }
                errManager.display("Failed to set System Date..." + (error !== undefined ? JSON.stringify(error) : ' - ') + ', ' + (message !== undefined ? message : ' - '));
            });
        }
</script>
</head>
<body>
<table width="100%">
    <tr>
        <td><h2>NMEA Multiplexer Admin</h2></td>
        <td align="center">Forwarders are <span id="forwarders-status" onclick="toggleForwarders();" title="Click to toggle value" style="cursor: pointer;"></span></td>
        <td align="center">
            Page CSS:
            <select id="css-select" onchange="cssSelectManager();" title="Page StyleSheet">
                <option value="stylesheet.css">Day</option>
                <option value="night.stylesheet.css">Night</option>
                <!-- More here if needed -->
            </select> &nbsp;
            Graph CSS:
            <select id="graph-css-select" onchange="graphCssSelectManager();" title="Graph StyleSheet">
                <option value="graph.ux.01.css">One</option>
                <option value="graph.ux.02.css">Two</option>
                <option value="graph.ux.03.css">Three</option>
                <!-- More here if needed -->
            </select>
        </td>
        <td align="right"><span style="cursor: pointer;">Flow <span id="flow" onclick="showHideGraph();" title="Click to show/hide graph"></span></span></td>
    </tr>
    <tr>
        <td colspan="4" align="center">
            <div id="graphdiv" class="smooth">
                <input type="checkbox" id="smooth-data" onchange="setSmooth(this);">Smoothed <input type="checkbox" id="with-tooltip" onchange="setTooltip(this);">Tooltip
                <br>
                <canvas id="flowCanvas" height="120" title="Flow History"></canvas>
            </div>
        </td>
    </tr>
    <tr>
        <td colspan="1" align="left">
            System Date:
            <input type="number" id="system-day" min="1" max="31" step="1" placeholder="Day" value="1">
            <select id="system-month">
                <option value="JAN" selected>JAN</option>
                <option value="FEB">FEB</option>
                <option value="MAR">MAR</option>
                <option value="APR">APR</option>
                <option value="MAY">MAY</option>
                <option value="JUN">JUN</option>
                <option value="JUL">JUL</option>
                <option value="AUG">AUG</option>
                <option value="SEP">SEP</option>
                <option value="OCT">OCT</option>
                <option value="NOV">NOV</option>
                <option value="DEC">DEC</option>
            </select>
            <input type="number" id="system-year" min="1970" max="3000" step="1" placeholder="Year" value="1970">
            <input type="number" id="system-hours" min="0" max="59" step="1" placeholder="Hour" value="0">
            <input type="number" id="system-mins" min="0" max="59" step="1" placeholder="Min" value="0">
            <input type="number" id="system-secs" min="0" max="59" step="1" placeholder="Sec" value="0">
            &nbsp;&nbsp;
            <button onclick="getSystemDate();">Get</button>
            &nbsp;
            <button onclick="setSystemDate();" title="Carefull !!&#13;Requires sudo - and password.">Set</button>
        </td>
        <td colspan="1" align="left">Bring the house down: <button title="Really? At your own risk..." onclick="shutdownMux();">Terminate <img src="images/bomb.png" width="30"></button></td>
        <td colspan="2" align="right"><input type="checkbox" id="show-inbound-data" onchange="showInboundData(this);">Show Inbound Data</td>
    </tr>
    <tr>
        <td colspan="4" align="left">
            <div id="inbound-data-div" class="smooth" style="padding: 1px; border-radius: 5px; border: 1px solid #CCC; min-height: 50px; max-height: 100px; overflow-y: scroll;">
            </div>
        </td>
    </tr>
</table>

<small>Ajax, REST, JSON..., Multiplexer Admin.</small>
<p>
<div style="margin-bottom: 0px;">
    <span id="showPorts"  onclick="manageClick(this);"  class="selectedButton" style="margin-left: 5px; cursor: pointer;">Fetch Serial Ports list <img src="refresh_icon.png" width="10" height="12"/></span>
    <span id="showChannels" onclick="manageClick(this);" class="unselectedButton" style="cursor: pointer;">Fetch Channels list <img src="refresh_icon.png" width="10" height="12"/></span>
    <span id="showForwarders" onclick="manageClick(this);" class="unselectedButton" style="cursor: pointer;">Fetch Forwarders list <img src="refresh_icon.png" width="10" height="12"/></span>
    <span id="showComputers" onclick="manageClick(this);" class="unselectedButton" style="cursor: pointer;">Fetch Computers list <img src="refresh_icon.png" width="10" height="12"/></span>
    <span id="showDiagram" onclick="manageClick(this);" class="unselectedButton" style="cursor: pointer;">Full view <img src="refresh_icon.png" width="10" height="12"/></span>
    <span id="showCache" onclick="manageClick(this);" class="unselectedButton" style="cursor: pointer;">Data Cache <img src="refresh_icon.png" width="10" height="12"/></span>
    <button onclick="resetCache();" style="margin-bottom: 3px;">Reset Cache</button>
    <input type='checkbox' onchange='manageMuxVerbose(this);'> Multiplexer verbose
</div>
<div id="lists" style="padding: 1px; border-radius: 5px; border: 1px solid #CCC; min-height: 50px; max-height: 200px; overflow-y: scroll;"></div>
<div id="diagram" style="display: none; padding: 1px; border-radius: 5px; border: 1px solid #CCC; min-height: 50px;"></div>
<div id="show-hide-raw-data" onclick="showHideRESTData();" style="cursor: pointer; margin-top: 5px;"><small>&nbsp;<img src='panright.gif'> Show REST Traffic</small></div>
<div id="raw-data-div" class="smooth">
    <table width="100%" border="0">
        <tr>
            <td style="width: 50%;" valign="top" title="In&#013;(From the server)">
                <div id="raw-data" style="padding: 1px; border-radius: 5px; border: 1px solid #CCC; min-height: 50px; max-height: 200px; overflow-y: scroll;"></div>
            </td>
            <td style="width: 40%;" valign="top" title="Out&#013;(From client to Server)">
                <div id="raw-data-out" style="padding: 1px; border-radius: 5px; border: 1px solid #CCC; min-height: 50px; max-height: 200px; overflow-y: scroll;"></div>
            </td>
            <td style="width: 10%;" valign="top" title="Elapsed">
                <div id="rest-elapsed" style="padding: 1px; border-radius: 5px; border: 1px solid #CCC; min-height: 50px; max-height: 200px; overflow-y: scroll;"></div>
            </td>
        </tr>
        <tr>
            <td colspan="1">
                <button onclick="clearRESTData();">Clear</button>
            </td>
            <td colspan="2">
                <button onclick="clearRESTOutData();">Clear</button>
            </td>
        </tr>
    </table>
</div>
</p>
<p>
    <button onclick="showAddChannel();"><img id="add-channel-icon" src='panright.gif'>Add a Channel</button>&nbsp;
    <button onclick="showAddForwarder();"><img id="add-fwrd-icon" src='panright.gif'>Add a Forwarder</button>&nbsp;
    <button onclick="showAddComputer();"><img id="add-comp-icon" src='panright.gif'>Add a Computer</button>
<div id="add-channel" class="smooth">
    <hr/>
    <h4>Add an input Channel</h4>
    <table style="padding: 5px; border-radius: 5px; border: 1px solid #CCC; margin-bottom: 5px;">
        <tr>
            <td valign="top">
                <select id="channel-select" onchange="channelSelectManager();">
                    <option value="serial">Serial</option>
                    <option value="tcp">TCP</option>
                    <option value="file">Data File</option>
                    <option value="ws">Web Socket</option>
                    <option value="rnd">Random</option>
                    <!--option value="bmp180">BMP180</option>
                    <option value="bme280">BME280</option>
                    <option value="lsm303">LSM303</option>
                    <option value="htu21df">HTU21DF</option-->
                    <option value="zda">ZDA</option>
                    <option value="rest">REST</option>
                    <option value="custom">Custom</option>
                </select>
            </td>
            <td valign="top">
                <div id="channel-serial" style="display: inline;">
                    <table>
                        <tr>
                            <td>Port</td>
                            <td><input id="serial-port" type="text" placeholder="Serial Port Name" size="30"></td>
                        </tr>
                        <tr>
                            <td>Baud Rate</td>
                            <td>
                                <select id="baud-rate">
                                    <option value="1200">1200</option>
                                    <option value="2400">2400</option>
                                    <option value="4800">4800</option>
                                    <option value="9600">9600</option>
                                    <option value="19200">19200</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Device filter(s)</td>
                            <td><input id="serial-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                        <tr>
                            <td>Sentence filter(s)</td>
                            <td><input id="serial-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                    </table>
                </div>
                <div id="channel-tcp" style="display: none;">
                    <table>
                        <tr>
                            <td>Server</td>
                            <td><input id="tcp-server" type="text" placeholder="Server Name or PI" size="20"></td>
                        </tr>
                        <tr>
                            <td>Port</td>
                            <td><input id="tcp-port" type="number" placeholder="Port" size="10"></td>
                        </tr>
                        <tr>
                            <td>Initial Request</td>
                            <td><input id="tcp-initial-request" type="text" placeholder="Initial Request ?" size="30"></td>
                        </tr>
                        <tr>
                            <td>Keep Trying</td>
                            <td><input id="tcp-keep-trying" type="checkbox"></td>
                        </tr>
                        <tr>
                            <td>Device filter(s)</td>
                            <td><input id="tcp-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                        <tr>
                            <td>Sentence filter(s)</td>
                            <td><input id="tcp-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                    </table>
                </div>
                <div id="channel-file" style="display: none;">
                    <table>
                        <tr>
                            <td>Data File</td>
                            <td><input id="data-file" type="text" placeholder="Log File" size="30"></td>
                        </tr>
                        <tr>
                            <td>Between reads</td>
                            <td><input id="data-between-reads" type="text" placeholder="500 ms" size="30"></td>
                        </tr>
                        <tr>
                            <td>Device filter(s)</td>
                            <td><input id="data-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                        <tr>
                            <td>Sentence filter(s)</td>
                            <td><input id="data-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                    </table>
                </div>
                <div id="channel-ws" style="display: none;">
                    <table>
                        <tr>
                            <td>WebSocket URI</td>
                            <td><input id="wsuri" type="text" placeholder="ws://machine-name:9876/" size="30"></td>
                        </tr>
                        <tr>
                            <td>Device filter(s)</td>
                            <td><input id="ws-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                        <tr>
                            <td>Sentence filter(s)</td>
                            <td><input id="ws-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                    </table>
                </div>
                <div id="channel-rnd" style="display: none;">
                    <table>
                        <tr>
                            <td>Device filter(s)</td>
                            <td><input id="rnd-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                        <tr>
                            <td>Sentence filter(s)</td>
                            <td><input id="rnd-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                    </table>
                </div>
                <!--div id="channel-bmp180" style="display: none;">
                  <table>
                    <tr>
                      <td>Device Prefix</td>
                      <td><input id="bmp180-dev-prefix" type="text" placeholder="Device Prefix" size="10" value="RP"></td>
                    </tr>
                    <tr>
                      <td>Device filter(s)</td>
                      <td><input id="bmp180-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                      <td><small>Negate with <b>~</b></small></td>
                    </tr>
                    <tr>
                      <td>Sentence filter(s)</td>
                      <td><input id="bmp180-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                      <td><small>Negate with <b>~</b></small></td>
                    </tr>
                  </table>
                </div-->
                <!--div id="channel-bme280" style="display: none;">
                  <table>
                    <tr>
                      <td>Device Prefix</td>
                      <td><input id="bme280-dev-prefix" type="text" placeholder="Device Prefix" size="10" value="RP"></td>
                    </tr>
                    <tr>
                      <td>Device filter(s)</td>
                      <td><input id="bme280-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                      <td><small>Negate with <b>~</b></small></td>
                    </tr>
                    <tr>
                      <td>Sentence filter(s)</td>
                      <td><input id="bme280-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                      <td><small>Negate with <b>~</b></small></td>
                    </tr>
                  </table>
                </div-->
                <!--div id="channel-lsm303" style="display: none;">
                  <table>
                    <tr>
                      <td>Device Prefix</td>
                      <td><input id="lsm303-dev-prefix" type="text" placeholder="Device Prefix" size="10" value="II"></td>
                    </tr>
                    <tr>
                      <td>Device filter(s)</td>
                      <td><input id="lsm303-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                      <td><small>Negate with <b>~</b></small></td>
                    </tr>
                    <tr>
                      <td>Sentence filter(s)</td>
                      <td><input id="lsm303-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                      <td><small>Negate with <b>~</b></small></td>
                    </tr>
                    <tr>
                      <td>Heading Offset</td>
                      <td><input id="lsm303-heading-offset" type="text" placeholder="0" size="4" style="text-align: right;"></td>
                      <td><small>Integer<b>[-180..180]</b></small></td>
                    </tr>
                                      <tr>
                                          <td>Read Frequency</td>
                                          <td><input id="lsm303-read-frequency" type="text" placeholder="1000" size="4" style="text-align: right;"></td>
                                          <td><small>in ms</small></td>
                                      </tr>
                                      <tr>
                                          <td>Damping Size</td>
                                          <td><input id="lsm303-damping-size" type="text" placeholder="200" size="4" style="text-align: right;"></td>
                                          <td><small>in elements</small></td>
                                      </tr>
                  </table>
                </div-->
                <div id="channel-zda" style="display: none;">
                    <table>
                        <tr>
                            <td>Device Prefix</td>
                            <td><input id="zda-dev-prefix" type="text" placeholder="Device Prefix" size="10" value="GP"></td>
                        </tr>
                        <tr>
                            <td>Device filter(s)</td>
                            <td><input id="zda-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                        <tr>
                            <td>Sentence filter(s)</td>
                            <td><input id="zda-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                    </table>
                </div>
                <!--div id="channel-htu21df" style="display: none;">
                  <table>
                    <tr>
                      <td>Device Prefix</td>
                      <td><input id="htu21df-dev-prefix" type="text" placeholder="Device Prefix" size="10" value="RP"></td>
                    </tr>
                    <tr>
                      <td>Device filter(s)</td>
                      <td><input id="htu21df-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                      <td><small>Negate with <b>~</b></small></td>
                    </tr>
                    <tr>
                      <td>Sentence filter(s)</td>
                      <td><input id="htu21df-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                      <td><small>Negate with <b>~</b></small></td>
                    </tr>
                  </table>
                </div-->
                <div id="channel-rest" style="display: none;">
                    <table>
                        <tr>
                            <td>Protocol</td>
                            <td>
                                <select id="rest-protocol">
                                    <option value="http">http</option>
                                    <option value="https">https</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Server</td>
                            <td><input id="rest-server" type="text" placeholder="Server Name" size="20"></td>
                        </tr>
                        <tr>
                            <td>Port</td>
                            <td><input id="rest-port" type="text" placeholder="Port" size="10"></td>
                        </tr>
                        <tr>
                            <td>path</td>
                            <td><input id="rest-path" type="text" placeholder="Path" size="10"></td>
                        </tr>
                        <tr>
                            <td>Query String</td>
                            <td><input id="rest-qs" type="text" placeholder="Query String" size="10"></td>
                        </tr>
                        <tr>
                            <td>JSON Query String</td>
                            <td><input id="rest-jqs" type="text" placeholder="JQ Formula" size="10"></td>
                        </tr>
                        <tr>
                            <td>frequency</td>
                            <td><input id="rest-freq" type="number" placeholder="Frequency" size="10" value="1000"></td>
                        </tr>
                        <tr>
                            <td>Device filter(s)</td>
                            <td><input id="rest-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                        <tr>
                            <td>Sentence filter(s)</td>
                            <td><input id="rest-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                    </table>
                </div>
                <div id="channel-custom" style="display: none;">
                    <table>
                        <tr>
                            <td>Client Class</td>
                            <td><input id="ch-custom-class" type="text" placeholder="Client Class" size="30"></td>
                        </tr>
                        <tr>
                            <td>Reader Class</td>
                            <td><input id="ch-custom-reader" type="text" placeholder="Reader Class" size="30"></td>
                        </tr>
                        <tr>
                            <td>Properties file</td>
                            <td><input id="ch-custom-prop-file" type="text" placeholder="Properties file name" size="30"></td>
                        </tr>
                        <tr>
                            <td>Device filter(s)</td>
                            <td><input id="ch-custom-dev-filters" type="text" placeholder="Device filters, II, ~GP" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                        <tr>
                            <td>Sentence filter(s)</td>
                            <td><input id="ch-custom-sentence-filters" type="text" placeholder="Sentence filters, GLL, ~RMC" size="30"></td>
                            <td><small>Negate with <b>~</b></small></td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
    </table>
    <button onclick="requestChannelCreation();">Add</button>
</div>
<div id="add-forwarder" class="smooth">
    <hr/>
    <h4>Add a forwarder</h4>
    <table style="padding: 5px; border-radius: 5px; border: 1px solid #CCC; margin-bottom: 5px;">
        <tr>
            <td valign="top">
                <select id="forwarder-select" onchange="forwardSelectManager();">
                    <option value="serial">Serial</option>
                    <option value="tcp">TCP</option>
                    <option value="rest">REST</option>
                    <option value="gpsd">GPSd</option>
                    <option value="rmi">RMI</option>
                    <option value="file">Data File</option>
                    <option value="ws">Web Socket</option>
                    <option value="console">Console</option>
                    <option value="custom">Custom</option>
                </select>
            </td>
            <td valign="top">
                <div id="forward-serial" style="display: inline;">
                    <table>
                        <tr>
                            <td>Port</td>
                            <td><input id="serial-port-fwd" type="text" placeholder="Serial Port Name" size="30"></td>
                        </tr>
                        <tr>
                            <td>Baud Rate</td>
                            <td>
                                <select id="baud-rate-fwd">
                                    <option value="1200">1200</option>
                                    <option value="2400">2400</option>
                                    <option value="4800">4800</option>
                                    <option value="9600">9600</option>
                                    <option value="19200">19200</option>
                                </select>
                            </td>
                        </tr>
                    </table>
                </div>
                <div id="forward-tcp" style="display: none;">
                    <table>
                        <tr>
                            <td>Port</td>
                            <td><input id="fwd-tcp-port" type="number" placeholder="Port" size="10"></td>
                        </tr>
                    </table>
                </div>
                <div id="forward-rest" style="display: none;">
                    <table>
                        <tr>
                            <td>Protocol</td>
                            <td>
                                <select id="fwd-rest-protocol">
                                    <option value="http">http</option>
                                    <option value="https">https</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Verb</td>
                            <td><input id="fwd-rest-verb" type="text" placeholder="POST" size="10"></td>
                        </tr>
                        <tr>
                            <td>Server Name or IP</td>
                            <td><input id="fwd-rest-server" type="text" placeholder="Server Name" size="30"></td>
                        </tr>
                        <tr>
                            <td>Port</td>
                            <td><input id="fwd-rest-port" type="number" placeholder="Port" size="10"></td>
                        </tr>
                        <tr>
                            <td>Resource</td>
                            <td><input id="fwd-rest-resource" type="text" placeholder="/resource" size="30"></td>
                        </tr>
                    </table>
                </div>
                <div id="forward-gpsd" style="display: none;">
                    <table>
                        <tr>
                            <td>Port</td>
                            <td><input id="fwd-gpsd-port" type="number" placeholder="Port, like 2947" size="10"></td>
                        </tr>
                    </table>
                </div>
                <div id="forward-rmi" style="display: none;">
                    <table>
                        <tr>
                            <td>Port</td>
                            <td><input id="fwd-rmi-port" type="number" placeholder="Port" size="10"></td>
                        </tr>
                        <tr>
                            <td>Binding Name</td>
                            <td><input id="fwd-rmi-binding-name" type="text" placeholder="Binding Name" size="20"></td>
                        </tr>
                    </table>
                </div>
                <div id="forward-file" style="display: none;">
                    <table>
                        <!--tr>
                          <td>Data File</td>
                        </tr-->
                        <tr>
                            <script type="text/javascript">
                      // Manage checkbox below
                      function flipFileOption(cb) {
                        console.log(`Box is ${cb.checked ? '' : 'NOT '}checked`);
                        if (cb.checked) {
                          document.getElementById('not-time-based').style.display = 'none';
                          document.getElementById('time-based').style.display = 'block';
                        } else {
                          document.getElementById('not-time-based').style.display = 'block';
                          document.getElementById('time-based').style.display = 'none';
                        }
                      }
                    </script>
                            <td>Time-based file name <input type="checkbox" id="tbfn" onchange="flipFileOption(this);"></td>
                        </tr>
                        <tr>
                            <td>
                                <div id="not-time-based" style="display: block;">
                                    <!-- NOT time-based file name Option, single file. -->
                                    <table>
                                        <tr>
                                            <td>File Name:</td><td><input id="fwd-data-file" type="text" placeholder="Log File" size="30"></td>
                                        </tr>
                                        <tr>
                                            <td colspan="2"><input type='checkbox' id="fwd-data-file-app" title="Reset, or append."> Append</td>
                                        </tr>
                                        <tr>
                                            <td colspan="2"><input type='checkbox' id="fwd-data-file-flush" title="Flush ?"> Flush</td>
                                        </tr>
                                    </table>
                                </div>
                                <div id="time-based" style="display: none;">
                                    <!-- time-based file name Option -->
                                    <table>
                                        <tr>
                                            <td>File Suffix:</td><td><input id="fwd-data-file-tb-suffix" type="text" placeholder="Suffix" size="10" value="_LOG" placeholder="Suffix"></td>
                                        </tr>
                                        <tr>
                                            <td>Log directory:</td><td><input id="fwd-data-file-tb-log-dir" type="text" placeholder="Log Dir" size="30" value="logged" placeholder="Log Dir"></td>
                                        </tr>
                                        <tr>
                                            <td>Split:</td>
                                            <td>
                                                <select id="fwd-data-file-tb-split">
                                                    <option value="minute">Minute</option>
                                                    <option value="hour" selected>Hour</option>
                                                    <option value="day">Day</option>
                                                    <option value="week">Week</option>
                                                    <option value="month">Month</option>
                                                    <option value="year">Year</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2"><input type='checkbox' id="fwd-data-file-tb-flush" title="Flush ?"> Flush</td>
                                        </tr>
                                    </table>

                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div id="forward-ws" style="display: none;">
                    <table>
                        <tr>
                            <td>WebSocket URI</td>
                            <td><input id="fwd-wsuri" type="text" placeholder="ws://machine-name:9876/" size="30"></td>
                        </tr>
                    </table>
                </div>
                <div id="forward-console" style="display: none;">
                    <i>No Parameters</i>
                </div>
                <div id="forward-custom" style="display: none;">
                    <table>
                        <tr>
                            <td>Forwarder Class</td>
                            <td><input id="fwd-custom-class" type="text" placeholder="Forwarder Class" size="30"></td>
                        </tr>
                        <tr>
                            <td>Properties file</td>
                            <td><input id="fwd-custom-prop-file" type="text" placeholder="Properties file name" size="30"></td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
    </table>
    <button onclick="requestForwardCreation();">Add</button>
</div>
<div id="add-computer" class="smooth">
    <hr/>
    <h4>Add a computer</h4>
    <table style="padding: 5px; border-radius: 5px; border: 1px solid #CCC; margin-bottom: 5px;">
        <tr>
            <td valign="top">
                <select id="computer-select" onchange="computerSelectManager();">
                    <option value="tw-current">True Wind and Current</option>
                    <option value="custom">Custom</option>
                </select>
            </td>
            <td valign="top">
                <div id="computer-twc" style="display: inline;">
                    <table>
                        <tr>
                            <td>Prefix</td>
                            <td><input id="cptr-twc-prefix" type="text" placeholder="OS" size="5"></td>
                        </tr>
                        <tr>
                            <td>Time Buffer Length</td>
                            <td><input id="cptr-twc-tbl" type="text" placeholder="60, 120, 300" size="30"> in <i>seconds</i>.</td>
                        </tr>
                    </table>
                </div>
                <div id="computer-custom" style="display: none;">
                    <table>
                        <tr>
                            <td>Computer Class</td>
                            <td><input id="cptr-custom-class" type="text" placeholder="Computer Class" size="30"></td>
                        </tr>
                        <tr>
                            <td>Properties file</td>
                            <td><input id="cptr-custom-prop-file" type="text" placeholder="Properties file name" size="30"></td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
    </table>
    <button onclick="requestComputerCreation();">Add</button>
</div>
<div id="err-mess" style="color: red; min-height: 0; max-height: 80px; overflow-y: auto; border: 1px solid silver; border-radius: 5px;"></div>
<hr/>
<!--button onclick="protocolTest();">Protocol test</button>
<hr/-->
<button onclick="document.location = './logMgmt.html';">Log files Management</button>
<hr/>
<address>Oliv fecit, AD 2016.</address>
</body>
</html>
